/*
 * Copyright (c) 2020 Laird Connectivity
 *
 * SPDX-License-Identifier: Apache-2.0
 */

/dts-v1/;
#include <nordic/nrf52833_qiaa.dtsi>
#include "alpha3_advanced-pinctrl.dtsi"

/ {
	model = "Cence Alpha3 Pico Module Advanced";
	compatible = "cence,alpha3_advanced";

	chosen {
		zephyr,console = &uart0;
		zephyr,shell-uart = &uart0;
		zephyr,uart-mcumgr = &uart0;
		zephyr,bt-mon-uart = &uart0;
		zephyr,bt-c2h-uart = &uart0;
		zephyr,sram = &sram0;
		zephyr,flash = &flash0;
        nordic,pm-ext-flash = &w25q128; 
        zephyr,code-partition = &slot0_partition;
	};

	//leds {
		//compatible = "gpio-leds";
		//led1: led_1 {
			//gpios = <&gpio0 13 GPIO_ACTIVE_LOW>;
			//label = "Blue LED 1";
		//};
		//led2: led_2 {
			//gpios = <&gpio0 14 GPIO_ACTIVE_LOW>;
			//label = "Blue LED 2";
		//};
		//led3: led_3 {
			//gpios = <&gpio0 15 GPIO_ACTIVE_LOW>;
			//label = "Blue LED 3";
		//};
		//led4: led_4 {
			//gpios = <&gpio0 16 GPIO_ACTIVE_LOW>;
			//label = "Blue LED 4";
		//};
	//};

	//buttons {
		//compatible = "gpio-keys";
		//button1: button_1 {
			//gpios = <&gpio0 11 GPIO_PULL_UP>;
			//label = "Push button switch 1 (SW1)";
		//};
		//button2: button_2 {
			//gpios = <&gpio0 12 GPIO_PULL_UP>;
			//label = "Push button switch 2 (SW2)";
		//};
		//button3: button_3 {
			//gpios = <&gpio0 24 GPIO_PULL_UP>;
			//label = "Push button switch 3 (SW9)";
		//};
		//button4: button_4 {
			//gpios = <&gpio0 22 GPIO_PULL_UP>;
			//label = "Push button switch 4 (SW10)";
		//};
	//};

	/* These aliases are provided for compatibility with samples */
	//aliases {
		//led0 = &led1;
		//led1 = &led2;
		//led2 = &led3;
		//led3 = &led4;
		//sw0 = &button1;
		//sw1 = &button2;
		//sw2 = &button3;
		//sw3 = &button4;
	//};
};

&adc {
	status = "okay";
};

&gpiote {
	status = "okay";
};

&gpio0 {
	status = "okay";
};

&gpio1 {
	status = "okay";
};

&uart0 {
	compatible = "nordic,nrf-uart";
	current-speed = <1000000>;
	status = "okay";
	pinctrl-0 = <&uart0_default>;
	pinctrl-1 = <&uart0_sleep>;
	pinctrl-names = "default", "sleep";
};

&i2c0 {
	compatible = "nordic,nrf-twim", "nordic,nrf-twi";
	status = "okay";

	pinctrl-0 = <&i2c0_default>;
	pinctrl-1 = <&i2c0_sleep>;
	pinctrl-names = "default", "sleep";

	eeprom0: eeprom@50 {
		compatible = "st,m24c64";
		reg = <0x50>;
		status = "disabled";
		label = "EEPROM_M24C64";
		size = <0x10000>;
		pagesize = <8>;
		address-width = <8>;
		timeout = <5>;
	};
};


&pwm0 {
	status = "okay";
	pinctrl-0 = <&pwm0_default>;
	pinctrl-1 = <&pwm0_sleep>;
	pinctrl-names = "default", "sleep";
};

&spi1 {
	compatible = "nordic,nrf-spim";
	status = "okay";
	cs-gpios = <&gpio0 14 GPIO_ACTIVE_LOW>;
	pinctrl-0 = <&spi1_default>;
	pinctrl-1 = <&spi1_sleep>;
	pinctrl-names = "default", "sleep";

    w25q128:w25q128jvsiq@0 {
        compatible = "jedec,spi-nor";
        reg = <0>;
        spi-max-frequency = <32000000>;
        label = "W25Q128";
        jedec-id = [ef 40 18];
        sfdp-bfp = [ 
            e5 20 f9 ff  ff ff ff 07  44 eb 08 6b  08 3b 42 bb
            fe ff ff ff  ff ff 00 00  ff ff 40 eb  0c 20 0f 52
            10 d8 00 00  36 02 a6 00  82 ea 14 c9  e9 63 76 33
            7a 75 7a 75  f7 a2 d5 5c  19 f7 4d ff  e9 30 f8 80
        ];
        size = <0x8000000>;
        hold-gpios = <&gpio0 30 GPIO_ACTIVE_LOW>;
        has-dpd;
        t-enter-dpd = <3000>;
        t-exit-dpd = <3000>;
    };
};

&flash0 {
	partitions {
		compatible = "fixed-partitions";
		#address-cells = <1>;
		#size-cells = <1>;

		boot_partition: partition@0 {
			label = "mcuboot";
			reg = <0x0 0x10000>;
		};

		slot0_partition: partition@10000 {
			label = "image-0";
			reg = <0x10000 0x68000>;
		};
		scratch_partition: partition@78000 {
			label = "image-scratch";
			reg = <0x78000 0x8000>;
		};
	};
};

&w25q128 {
    partitions {
        compatible = "fixed-partitions"; 
        #address-cells = <1>;
        #size-cells = <1>;
		slot1_partition: partition@0 {
			label = "image-1";
			reg = <0x0 0x68000>;
		};
		lfs_partition: partition@64000 {
			label = "image-storage";
			reg = <0x68000 0xf98000>;
		};

    };
};

zephyr_udc0: &usbd {
	compatible = "nordic,nrf-usbd";
	status = "okay";
};
